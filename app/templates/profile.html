{% extends "base.html" %}
{% import 'bootstrap/wtf.html' as wtf %}

{% block app_content %}

<div class="col-12 mt-2 mx-auto">
  <div class="card h-100">
    <h2 class="card-header">Player Profile</h2>

    <!-- Nav tabs -->
    <ul class="nav nav-tabs" id="myTab" role="tablist">
      <li class="nav-item">
        <a class="nav-link" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="profile" aria-selected="true">Profile</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" id="player-tab" data-toggle="tab" href="#player" role="tab" aria-controls="player" aria-selected="false">Player</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" id="settings-tab" data-toggle="tab" href="#settings" role="tab" aria-controls="settings" aria-selected="false">Settings</a>
      </li>
    </ul>

    <!-- Tab panes -->
    <div class="tab-content">
      <div class="tab-pane active" id="profile" role="tabpanel" aria-labelledby="profile-tab">
        <div class="col-12 mt-2 mx-auto">
          <p>Username: {{ current_user.username }}</p>
          <p>Email: {{ current_user.email }}</p>
          <p>Role: {{ current_user.role }}</p>
        </div>    
      </div>
      <div class="tab-pane" id="player" role="tabpanel" aria-labelledby="player-tab">
        <div class="col-6 mt-2 mx-auto">
        {% if not current_user.player %}
            <p>You have not selected a player. Please complete the details below:</p>
            <form class="form" method="post" role="form">
                {{ player_form.hidden_tag() }}
                {{ wtf.form_errors(player_form, hiddens="only") }}

                {{ wtf.form_field(player_form.nickname) }}
                {{ wtf.form_field(player_form.first_name) }}
                {{ wtf.form_field(player_form.last_name) }}

                {{ wtf.form_field(player_form.submit_edit, button_map={'submit_edit': 'info my-1 btn-block'}) }}
              </form>
        {% else %}
            <p>Playername: {{ current_user.nickname }}</p>
            <p>Firstname: {{ current_user.first_name }}</p>
            <p>Lastname: {{ current_user.last_name }}</p>
            <p>Active: {% if current_user.is_active %}Yes{% else %}No{% endif %}</p>
            <p>Player page: <a href="{{ url_for('main.player', nickname=player.nickname) }}">link</a></p>
        {% endif %}
        </div>
      </div>
      <div class="tab-pane" id="settings" role="tabpanel" aria-labelledby="settings-tab">...</div>
    </div>




  </div>
</div>

{% endblock %}

{% block scripts %}
{{ super() }}
<script>
$(function(){
  var hash = window.location.hash;
  hash && $('ul.nav a[href="' + hash + '"]').tab('show');

  $('.nav-tabs a').click(function (e) {
    $(this).tab('show');
    var scrollmem = $('body').scrollTop() || $('html').scrollTop();
    window.location.hash = this.hash;
    $('html,body').scrollTop(scrollmem);
  });
});
</script>
{% endblock %}
